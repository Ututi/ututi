File upload and download
========================

First let's log in.

    >>> browser = Browser.logIn()
    >>> browser.open('http://localhost/admin/files')
    >>> browser.printQuery("//h1/text()")
    Files

There should be a form to upload a new file.

    >>> form = browser.getForm('file_upload_form')
    >>> form.getControl('Title').value = "a file"
    >>> form.getControl('Description').value = "a new file"
    >>> import cStringIO
    >>> form.getControl('Upload').add_file(cStringIO.StringIO('The contents of the file.'), 'text/plain', 'file.txt')
    >>> form.getControl('Save').click()

Having uploaded the file, we should be presented with a list of all files present, with our new file available.

    >>> browser.printQuery('id("file_list")//a/text()')
    a file
    >>> browser.getLink("a file").click()
    >>> browser.contents
    'The contents of the file.'

The files is stored in our upload directory:

    >>> from ututi.tests.functional import listUploads
    >>> listUploads()
    /uploads/11865bf8/24c684d6/ceb7b850/77e94c7c
