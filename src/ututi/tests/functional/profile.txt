User profiles
=============

    >>> from pkg_resources import resource_stream
    >>> def make_file(filename):
    ...     stream = resource_stream("ututi.tests.functional.import", filename)
    ...     return (stream, 'text/plain', filename)

Each user will have a profile that is accessible via the url /profile/{id}.

    >>> browser = Browser()
    >>> browser.open('http://localhost/profile/1')
    >>> browser.printQuery('//h1/text()')
    Adminas Adminovix

Now we'll try editing our profile information. First we need to log in.

    >>> browser.open('http://localhost/')
    >>> form = browser.getForm('login_form')
    >>> form.getControl('Email').value = "admin@ututi.lt"
    >>> form.getControl('Password').value = "asdasd"
    >>> form.getControl('Login').click()

    >>> browser.printQuery("id('personal-box')//span[@class='fullname']/text()")
    Adminas Adminovix

We'll go to our profile edit page. And change our name as well as upload a logo.

    >>> browser.open('http://localhost/user/edit')
    >>> browser.getControl('Full name').value = 'Adminas Adminas'
    >>> browser.getControl('Personal logo').add_file(*make_file('test_logo.png'))
    >>> browser.getControl('Save').click()
    >>> browser.printQuery("id('personal-box')//span[@class='fullname']/text()")
    Adminas Adminas
    >>> browser.printQuery("id('personal-box')//div[@class='personal-logo']/img")
    <img src="/profile/1/logo/45/60" alt="logo" />

Let's check out the logo.
    >>> browser.open('http://localhost/profile/1/logo/45/60')

The content type should be PNG (all resized images are served as PNGs).

    >>> browser.headers['content-type']
    'image/png'

The size of the image should be as was specified in the request.

    >>> from PIL import Image
    >>> import StringIO
    >>> im = Image.open(StringIO.StringIO(browser.contents))
    >>> im.size[0] <= 45
    True
    >>> im.size[1] <= 60
    True

Now let's try to delete the logo.

    >>> browser.open('http://localhost/user/edit')
    >>> browser.getControl('Delete current logo').selected = True
    >>> browser.getControl('Save').click()
    >>> browser.printQuery("id('personal-box')//div[@class='personal-logo']/img")




