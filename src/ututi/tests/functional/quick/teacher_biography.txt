Test teacher's "biography" functionality
================================================

    >>> from ututi.lib.mailer import mail_queue
    >>> from ututi.lib.helpers import get_urls

User may press "I teach here" button in university page and have
the same registration flow as any other user. In the end, he
will be registered as teacher:

    >>> user = Browser()
    >>> user.open('http://localhost/school/uni')
    >>> user.click('I teach here')
    >>> user.getControl('Enter your academic email').value = 'user@example.com'
    >>> user.click('Sign Up')
    >>> msg = mail_queue.pop()
    >>> urls = get_urls(msg.payload())
    >>> user.open(urls[0])
    >>> user.click('Next')
    >>> user.getControl('Full name').value = 'User'
    >>> user.getControl('Password').value = 'password'
    >>> user.click('Next')
    >>> user.click('Skip')
    >>> user.click('Finish')

Even though teacher is not verified, he can fill his profile information.
From the "Get started" page he can click "Add biography".

    >>> user.click('Add biography')
    >>> user.url
    'http://localhost/profile/edit/biography?'

For the first time text area contains a template that teacher can edit.
It also displays a related warning message:

    >>> print user.getControl('Edit your biography').value
    Provide any personal information that you would like to begin with.
    Research interests
    Include a brief summary of your interests. Cover past, current and future research plans.
    Use bulleted list if needed.
    Education
    ...

    >>> user.printCssQuery('.warning', strip=True)
    <p>Below you see a template that you can freely edit.
    Note that once your press "Save", it will become publicly
    available in your profile page.</p>



    >>> user.getControl('Edit your biography').value = "Some <strong>cool</strong> biography!"
    >>> user.getControl('Save').click()

Biography should be created and we should see flash message.

    >>> user.printCssQuery('.flash-message-content', strip=True)
    <span>Your biography was updated.</span>
    <span>At the moment you are not confirmed as teacher. Our administrators have been notified and will verify you shortly.</span>

Now let's go to Public profile and look at biography tab. Here should be our biography.

    >>> user.click('Public profile')
    >>> user.click('Biography')
    >>> user.printCssQuery('#teacher-biography')
    <div id="teacher-biography" class="wiki-page">
         Some <strong>cool</strong> biography!
    </div>

Regression test: saving in profile settings form does not reset
teacher's biography:

    >>> user.click('Settings')
    >>> user.click('Save')
    >>> user.click('Public profile')
    >>> user.click('Biography')
    >>> user.printCssQuery('#teacher-biography')
    <div id="teacher-biography" class="wiki-page">
         Some <strong>cool</strong> biography!
    </div>


After user is verified as a teacher, he still can edit his biography
in settings page:

    >>> admin = Browser.logIn()
    >>> admin.open('http://localhost/admin')
    >>> admin.click('Teachers')
    >>> admin.click('Confirm')

    >>> user.click('Settings')
    >>> user.click('Biography')
    >>> user.getControl('Edit your biography').value
    'Some <strong>cool</strong> biography!'
    >>> user.getControl('Edit your biography').value = 'Some <strong>very cool</strong> biography!'
    >>> user.getControl('Save').click()
    >>> user.printCssQuery('.flash-message-content', strip=True)
    <span>Your biography was updated.</span>
    >>> user.click('Public profile')
    >>> user.click('Biography')
    >>> user.printCssQuery('#teacher-biography')
    <div id="teacher-biography" class="wiki-page">
         Some <strong>very cool</strong> biography!
    </div>

Mail queue is irrelevant for this test:

    >>> mail_queue[:] = []
