Sub departments for universities
================================

    >>> browser = Browser.logIn()

Before adding subjecs we add some sub-departments:

    >>> browser.getLink('My University').click()
    >>> browser.getLink('Edit information').click()
    >>> browser.getLink('Sub-departments').click()
    >>> browser.getControl('Add new sub-department').click()
    >>> browser.getControl('Sub department title:').value = 'IT sub-department'
    >>> browser.getControl('Description:').value = 'It does IT'
    >>> browser.getControl('Save').click()

    >>> browser.getControl('Add new sub-department').click()
    >>> browser.getControl('Sub department title:').value = 'OP sub-department'
    >>> browser.getControl('Description:').value = 'It is OP'
    >>> browser.getControl('Save').click()

The department should be in the list now:

    >>> browser.printCssQuery('table.content a')
    <a href="/school/uni/edit/edit_sub_department/...">IT sub-department</a>
    <a href="/school/uni/edit/edit_sub_department/...">OP sub-department</a>

If we try adding a subject we should be able to set it's
sub-department now:

    >>> browser.open('http://localhost/subjects/add')
    >>> browser.getControl('Subject title:').value = 'Test subject'
    >>> browser.getControl('Next').click()

    >>> browser.getControl('Sub-department').displayOptions
    [None, 'IT sub-department', 'OP sub-department']

    >>> browser.getControl('Sub-department').displayValue = ['IT sub-department']
    >>> browser.getControl('Create').click()

We can change it later if we want to:

    >>> browser.getLink('Edit Settings').click()
    >>> browser.getControl('Sub-department').displayValue
    ['IT sub-department']

    >>> browser.getControl('Sub-department').displayValue = ['OP sub-department']
    >>> browser.getControl('Save').click()

Now if we go to the list of subjects in the university:

    >>> browser.getLink('My University').click()
    >>> browser.getLink('Subjects').click()

We should see a list of all the sub-departments that have subjects in
them:

    >>> browser.printCssQuery(".sub-department-item a")
    <a href="/school/uni/subjects?sub_department_id=2">OP sub-department</a>

    >>> browser.getLink('OP sub-department').click()
    >>> browser.url
    'http://localhost/school/uni/subjects?sub_department_id=2'

    >>> browser.printCssQuery(".item-title a")
    <a href="/subject/uni/test_subject" title="Test subject">Test subject</a>

    >>> browser.open('http://localhost/school/uni/subjects?sub_department_id=1')
    >>> browser.printCssQuery(".item-title a")
