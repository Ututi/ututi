Test changing the password
==========================

    >>> browser = Browser.logIn()
    >>> browser.getLink('Settings').click()
    >>> browser.getLink('Change password').click()
    >>> browser.url
    'http://localhost/profile/edit/password'

Let's try changing the password:

    >>> form = browser.getForm('change_password_form')
    >>> form.getControl('Current password').value = 'asdasd'
    >>> form.getControl('New password').value = 'newnew'
    >>> form.getControl('Repeat the new password').value = 'newnew'
    >>> form.getControl('Change password').click()

    >>> browser.url
    'http://localhost/home'

    >>> browser.getLink('log out').click()
    >>> browser.url
    'http://localhost/'

    >>> browser = Browser.logIn(password='newnew')
    >>> browser.url
    'http://localhost/home'

We should be unable to change the password if we do enter the current one:

    >>> browser.getLink('Settings').click()
    >>> browser.getLink('Change password').click()

    >>> form = browser.getForm('change_password_form')
    >>> form.getControl('Current password').value = 'forgot my pass k thx bai'
    >>> form.getControl('New password').value = 'newnew'
    >>> form.getControl('Repeat the new password').value = 'newnew'
    >>> form.getControl('Change password').click()

    >>> browser.url
    'http://localhost/profile/password'

Password form should be empty:

    >>> browser.open('http://localhost/profile/edit/password')
    >>> form = browser.getForm('change_password_form')
    >>> form.getControl('Current password').value
    ''

    >>> form.getControl('New password').value
    ''

    >>> form.getControl('Repeat the new password').value
    ''

Or enter an invalid new one:

    >>> form = browser.getForm('change_password_form')
    >>> form.getControl('Current password').value = 'newnew'
    >>> form.getControl('New password').value = 'new'
    >>> form.getControl('Repeat the new password').value = 'new'
    >>> form.getControl('Change password').click()

    >>> browser.url
    'http://localhost/profile/password'

Or, for that matter enter non-matching new passwords:

    >>> form = browser.getForm('change_password_form')
    >>> form.getControl('Current password').value = 'newnew'
    >>> form.getControl('New password').value = 'new'
    >>> form.getControl('Repeat the new password').value = 'newER'
    >>> form.getControl('Change password').click()

    >>> browser.url
    'http://localhost/profile/password'

Or do not enter an old password at all:

    >>> form = browser.getForm('change_password_form')
    >>> form.getControl('Current password').value = ''
    >>> form.getControl('New password').value = 'newnew'
    >>> form.getControl('Repeat the new password').value = 'newnew'
    >>> form.getControl('Change password').click()

    >>> browser.url
    'http://localhost/profile/password'
