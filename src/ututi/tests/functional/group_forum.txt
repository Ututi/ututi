Group forums
============

First of all let's log in;

    >>> browser = Browser.logIn()

Let's find the group:

    >>> browser.open('http://localhost/group/moderators')
    >>> browser.url
    'http://localhost/group/moderators/home'

    >>> browser.getLink('Edit').click()

    >>> browser.getControl('Forum type').value = ['forum']
    >>> browser.getControl('Save').click()

    >>> browser.url
    'http://localhost/group/moderators/home'

Let's enter the forum:

    >>> browser.getLink('Forum').click()

There should be a default category, 'General':

    >>> browser.getLink('General').click()

Let's start a thread:

    >>> browser.getLink('New topic').click()
    >>> browser.getControl(name='title').value = "What's up?"
    >>> browser.getControl(name='message').value = "How's everybody doin'?"
    >>> browser.getControl('Post').click()

A notification to subscribed group members has been sent by email:

    >>> from ututi.lib.mailer import mail_queue
    >>> msg = mail_queue.pop()
    >>> msg.recipients
    ['admin@ututi.lt']
    >>> print msg.message
    MIME-Version: 1.0
    Content-Type: text/plain; charset="us-ascii"
    Content-Transfer-Encoding: 7bit
    From: admin@ututi.lt
    To: moderators@groups.ututi.lt
    Subject: What's up?
    Message-ID: <...@groups.ututi.lt>
    Reply-To: moderators@groups.ututi.lt
    Errors-To: errors@ututi.lt
    List-Id: moderators@groups.ututi.lt
    <BLANKLINE>
    How's everybody doin'?
    <BLANKLINE>
    /group/moderators/forum/3/thread/3

And we'll post a reply:

    >>> browser.getControl(name='message').value = 'Not too bad!'
    >>> browser.getControl('Reply').click()

Email notifications about the reply have also been sent:

    >>> msg = mail_queue.pop()
    >>> msg.recipients
    ['admin@ututi.lt']
    >>> print msg.message
    MIME-Version: 1.0
    Content-Type: text/plain; charset="us-ascii"
    Content-Transfer-Encoding: 7bit
    From: admin@ututi.lt
    To: moderators@groups.ututi.lt
    Subject: What's up?
    Message-ID: <...@groups.ututi.lt>
    Reply-To: moderators@groups.ututi.lt
    Errors-To: errors@ututi.lt
    List-Id: moderators@groups.ututi.lt
    <BLANKLINE>
    Not too bad!
    <BLANKLINE>
    /group/moderators/forum/3/thread/3

We can see the messages we posted:

    >>> browser.printQuery('//div[@class="post-body"]')
    <div class="post-body">
            How's everybody doin'?
          </div>
    <div class="post-body">
            Not too bad!
          </div>

Let's go back to the topic list.

    >>> browser.getLink('Back to the topic list').click()

    >>> browser.printQuery('//td[@class="subject"]')
    <td class="subject">
      <a class="thread-subject" href="/group/moderators/forum/3/thread/3">What's up?</a>
    </td>

And all the way up to the category list:

    >>> browser.getLink('Back to category list').click()

    >>> browser.printQuery('//h2[@class="category"]')
    <h2 class="category">
      <a href="/group/moderators/forum/3">General</a>
    </h2>
