Group welcome page
==================

First of all let's log in;

    >>> browser = Browser.logIn()

We can add a group at the url /groups/add.

    >>> browser.open('http://localhost/groups/add')
    >>> browser.getControl('Group email address').value = 'test'
    >>> browser.getControl('Group title').value = 'Test group'
    >>> browser.getControl('Year').value = ['2009']
    >>> browser.getControl(name='location-0').value = 'Vilniaus universitetas'
    >>> browser.getControl('Continue').click()

We skip the member invitation step:

    >>> browser.getControl("Continue").click()

And get to the group welcome page:

    >>> print browser.url
    http://localhost/group/test/welcome

In which we see a box suggesting us to invite more members:

    >>> browser.printQuery("id('invite_more_members')")
    <div id="invite_more_members" class="full_box">
      <div class="wrapper">
        <div class="inner">
          <table>
            <tr>
              <td>
                <h2>Invite group members!</h2>
                <div class="description">
                  It's easy - you just have to know their email addresses! You can
                  use the group mailing list together then!
                </div>
              </td>
              <td style="width: 170px; text-align: right;">
                <form action="/group/test/members" class="button-to" method="post">
                  <fieldset>
                    <button class="btnLarge" type="submit" value="Invite friends">
                      <span>Invite friends</span>
                    </button>
                  </fieldset>
                </form>
              </td>
            </tr>
          </table>
        </div>
      </div>
    </div>

Also we see a box that suggest us to watch some subjects:

    >>> browser.printQuery("id('watch_more_subjects')")
    <div id="watch_more_subjects" class="full_box">
      <div class="wrapper">
        <div class="inner">
          <table>
            <tr>
              <td>
                <h2>Watch subjects you are studying!</h2>
                <div class="description">
                  Find the subjects your group is studying and add them to the list
                  of watched subjects.  Upload files for the subjects without any
                  limitations!
                </div>
              </td>
              <td style="width: 170px; text-align: right;">
                <a class="btn-large" href="/group/test/subjects">
                  <span>Watch subjects</span>
                </a>
                <br />
                <span style="padding-right: 5px;">
                  <a href="/group/test/home?do_not_watch=True" class="cancel_link">no, thank you</a>
                </span>
              </td>
            </tr>
          </table>
        </div>
      </div>
    </div>

If we invite a member into the system, the member box should
disappear:

    >>> browser.getControl('Invite friends').click()
    >>> emails = 'user@ututi.lt'
    >>> browser.getControl('Enter emails of the people you would like to invite to the group.').value = emails
    >>> browser.getControl('Invite').click()
    >>> browser.getLink('Test group').click()

When we go back to what's new, we only see the watch more subjects
box:

    >>> browser.printQuery("id('invite_more_members')")

    >>> browser.printQuery("id('watch_more_subjects')")
    <div id="watch_more_subjects" class="full_box">
    ...
    </div>

By the way - we are looking at the group home page now:

    >>> browser.url
    'http://localhost/group/test/home'

Let's watch some subjects:

    >>> browser.getLink('Subjects').click()
    >>> browser.getControl('add a subject').click()
    >>> subjects_url = browser.url
    >>> browser.getLink('Watch').click()
    >>> browser.getLink("What's New?", url='group').click()

And the subject watching box is gone:

    >>> browser.printQuery("id('watch_more_subjects')")

If we stop watching the subject though, the box reappears:

    >>> browser.open(subjects_url)
    >>> browser.getLink(url='unwatch_subject').click()
    >>> browser.getLink("What's New?", url='group').click()

    >>> browser.printQuery("id('watch_more_subjects')")
    <div id="watch_more_subjects" class="full_box">
    ...
    </div>

But we can just cancel it by clicking the 'no, thanks' link:

    >>> browser.getLink('no, thank you').click()
    >>> browser.printQuery("id('watch_more_subjects')")

And the box is no more.

    >>> from ututi.lib.mailer import mail_queue
    >>> mail_queue[:] = []
