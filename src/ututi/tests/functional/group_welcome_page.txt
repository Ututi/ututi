Group welcome page
==================

First of all let's log in;

    >>> browser = Browser.logIn()

We can add a group at the url /groups/add.

    >>> browser.getLink('Create group').click()
    >>> browser.getControl('Group e-mail address').value = 'test'
    >>> browser.getControl('Group title').value = 'Test group'
    >>> browser.getControl('Year').value = ['2009']
    >>> browser.getControl(name='location-0').value = 'Vilniaus universitetas'
    >>> browser.getControl('Continue').click()

We skip the member invitation step:

    >>> browser.getControl("Finish").click()

And get to the group welcome page:

    >>> print browser.url
    http://localhost/group/test/welcome

In which we see a box suggesting us to invite more members:

    >>> browser.printQuery("id('invite_members_block')")
    <div class="portlet portletSmall portletInviteMembers" id="invite_members_block">
      <div class="ctl"></div>
      <div class="ctr"></div>
      <div class="cbl"></div>
      <div class="cbr"></div>
      <div class="floatleft usergrupeleft">
        <h2 class="portletTitle bold">Invite group members!</h2>
    <BLANKLINE>
    It's easy - you just have to know their email addresses! You can
    use the group mailing list together then!
    <BLANKLINE>
        </div>
      <div class="floatright">
        <form action="/group/test/members" class="button-to" method="post">
          <fieldset>
            <button class="btnMedium" type="submit" value="Invite friends">
              <span>Invite friends</span>
            </button>
          </fieldset>
        </form>
      </div>
      <br class="clear-left" />
    </div>

Also we see a box that suggest us to watch some subjects:

    >>> browser.printQuery("id('watch_subjects_block')")
    <div class="portlet portletSmall portletNewDalykas" id="watch_subjects_block">
      <div class="ctl"></div>
      <div class="ctr"></div>
      <div class="cbl"></div>
      <div class="cbr"></div>
      <div class="floatleft usergrupeleft">
        <h2 class="portletTitle bold">Watch subjects you are studying!</h2>
        <ul id="prosList">
          <li>Find materials shared by others</li>
          <li>Get notifications about changes</li>
        </ul>
      </div>
      <div class="floatright">
        <form action="/group/test/subjects" class="button-to" method="post">
          <fieldset>
            <button class="btnMedium" type="submit" value="Watch subjects">
              <span>Watch subjects</span>
            </button>
          </fieldset>
        </form>
        <br class="clear-left" />
        <span>
          <a href="/group/test/home?do_not_watch=True" class="cancel_link">no, thank you</a>
        </span>
      </div>
      <br class="clear-left" />
    </div>

If we invite a member into the system, the member box should
disappear:

    >>> browser.getControl('Invite friends').click()
    >>> emails = 'user@ututi.lt'
    >>> browser.getControl(name='emails').value = emails
    >>> browser.getControl('Invite').click()
    >>> browser.getLink('Test group').click()

When we go back to what's new, we only see the watch more subjects
box:

    >>> browser.printQuery("id('invite_members_block')")

    >>> browser.printQuery("id('watch_subjects_block')")
    <div class="portlet portletSmall portletNewDalykas" id="watch_subjects_block">
    ...
    </div>

By the way - we are looking at the group home page now:

    >>> browser.url
    'http://localhost/group/test/home'

Let's watch some subjects:

    >>> browser.getLink('Subjects').click()
    >>> browser.getControl('add a subject').click()
    >>> subjects_url = browser.url
    >>> browser.getLink('Watch').click()
    >>> browser.getLink("News wall", url='group').click()

And the subject watching box is gone:

    >>> browser.printQuery("id('watch_subjects_block')")

If we stop watching the subject though, the box reappears:

    >>> browser.open(subjects_url)
    >>> browser.getLink(url='unwatch_subject').click()
    >>> browser.getLink("News wall", url='group').click()

    >>> browser.printQuery("id('watch_subjects_block')")
    <div class="portlet portletSmall portletNewDalykas" id="watch_subjects_block">
    ...
    </div>

But we can just cancel it by clicking the 'no, thanks' link:

    >>> browser.getLink('no, thank you').click()
    >>> browser.printQuery("id('watch_subjects_block')")

And the box is no more.

    >>> from ututi.lib.mailer import mail_queue
    >>> mail_queue[:] = []
