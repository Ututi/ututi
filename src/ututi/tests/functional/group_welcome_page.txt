Group welcome page
==================

First of all let's log in;

    >>> browser = Browser.logIn()

We can add a group at the url /groups/add.

    >>> browser.getLink('Create new group').click()
    >>> browser.getControl('Email address:').value = 'test'
    >>> browser.getControl('Title').value = 'Test group'
    >>> browser.getControl('Year:').value = ['2009']
    >>> browser.getControl(name='location-0').value = 'Vilniaus universitetas'
    >>> browser.getControl('Continue').click()

We skip the member invitation step:

    >>> browser.getControl("Finish").click()

And get to the group welcome page:

    >>> print browser.url
    http://localhost/group/test/welcome

In which we see a box suggesting us to invite more members:

    >>> browser.printCssQuery("#invite_members_block", strip=True)
    <div>
      <div></div>
      <div></div>
      <div></div>
      <div></div>
      <div>
        <h2>Invite group members!</h2>
    <BLANKLINE>
    <p>It's easy - you just have to know their email addresses! You can
    use the group mailing list together then!</p>
    <BLANKLINE>
        </div>
      <div>
        <form>
          <fieldset>
            <button>
              <span>Invite friends</span>
            </button>
          </fieldset>
        </form>
      </div>
      <br />
    </div>

Also we see a box that suggest us to watch some subjects:

    >>> browser.printCssQuery("#watch_subjects_block", strip=True)
    <div>
      <div></div>
      <div></div>
      <div></div>
      <div></div>
      <div>
        <h2>Watch subjects you are studying!</h2>
        <ul>
          <li>Find materials shared by others</li>
          <li>Get notifications about changes</li>
        </ul>
      </div>
      <div>
        <form>
          <fieldset>
            <button>
              <span>Watch subjects</span>
            </button>
          </fieldset>
        </form>
        <br />
        <span>
          <a>no, thank you</a>
        </span>
      </div>
      <br />
    </div>

If we invite a member into the system, the member box should
disappear:

    >>> browser.getControl('Invite friends').click()
    >>> emails = 'user@ututi.lt'
    >>> form = browser.getForm(id='member_invitation_form')
    >>> form.getControl(name='emails').value = emails
    >>> form.getControl('Invite').click()

When we go back to what's new, we only see the watch more subjects
box:

    >>> browser.getLink('News feed').click()
    >>> browser.printCssQuery("#invite_members_block", strip=True)

    >>> browser.printCssQuery("#watch_subjects_block", strip=True)
    <div>
    ...
    </div>

By the way - we are looking at the group home page now:

    >>> browser.url
    'http://localhost/group/test/home'

Let's watch some subjects:

    >>> browser.getLink('Subjects').click()
    >>> browser.getControl('add new subject').click()
    >>> subjects_url = browser.url
    >>> browser.getLink('Watch').click()
    >>> browser.getLink("News feed", url='group').click()

And the subject watching box is gone:

    >>> browser.printCssQuery("#watch_subjects_block", strip=True)

If we stop watching the subject though, the box reappears:

    >>> browser.open(subjects_url)
    >>> browser.getLink(url='unwatch_subject').click()
    >>> browser.getLink("News feed", url='group').click()

    >>> browser.printCssQuery("#watch_subjects_block", strip=True)
    <div>
    ...
    </div>

But we can just cancel it by clicking the 'no, thanks' link:

    >>> browser.getLink('no, thank you').click()
    >>> browser.printCssQuery("#watch_subjects_block", strip=True)

And the box is no more.

    >>> from ututi.lib.mailer import mail_queue
    >>> mail_queue[:] = []
