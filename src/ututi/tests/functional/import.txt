User information import
=======================

First we log in to be able to see the user list.

    >>> browser = Browser()
    >>> browser.open('http://localhost/')
    >>> form = browser.getForm('login_form')
    >>> form.getControl('Email').value = "admin@ututi.lt"
    >>> form.getControl('Password').value = "asdasd"
    >>> form.getControl('Login').click()

    >>> browser.open('http://localhost/admin')
    >>> browser.printQuery('//h2')

    >>> browser.open('http://localhost/admin/users')

There is one initial user:

    >>> browser.printQuery("id('user_list')//li/text()")
    Adminas Adminovix
    <BLANKLINE>
    Alternative user
    <BLANKLINE>

We go to the import page. There we have a form to upload a user CSV file:

    >>> browser.open('http://localhost/admin')
    >>> form = browser.getForm(name='import_users')
    >>> csv_data = 'domas, {SSHA}o4nmuRFCZCGxWpvz7FSd4I4wGhTrSfPH4tUc, Domas Monkus, domas@ututi.lt, 2009/05/20, 2009/06/06, '
    >>> import cStringIO
    >>> form.getControl('CSV File').add_file(cStringIO.StringIO(csv_data),
    ...                                      'text/plain',
    ...                                       'users.csv')
    >>> form.getControl('Upload').click()
    >>> browser.open('http://localhost/admin/users')
    >>> browser.printQuery("id('user_list')//li/text()")
    Adminas Adminovix
    Alternative user
    Domas Monkus

Now we will log out and see if we can log back in as the imported user.

    >>> browser.open('http://localhost/')
    >>> browser.getLink('Log out').click()

    >>> form = browser.getForm('login_form')
    >>> form.getControl('Email').value = "domas@ututi.lt"
    >>> form.getControl('Password').value = "asdasd"
    >>> form.getControl('Login').click()

    >>> browser.printQuery("id('page-content')/fieldset/legend/text()")
    Welcome to Ututi!

XXX test more than 1 user import
XXX test importing the same file twice
XXX test importing with mixed case emails
