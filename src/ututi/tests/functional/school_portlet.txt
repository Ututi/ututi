School portlet tests
====================


SETING UP

    >>> from pkg_resources import resource_stream
    >>> from ututi.tests.functional import make_file

    >>> browser = Browser.logIn()
    >>> browser.open('http://localhost/structure')

    >>> form = browser.getForm(name='new_structure_form')
    >>> form.getControl('Title').value = 'Vilniaus Gedimino Technikos Universitetas'
    >>> form.getControl('Short title').value = 'vgtu'
    >>> form.getControl('Description').value = ''
    >>> form.getControl('Parent').displayOptions
    ['Select a parent', 'U-niversity', 'Vilniaus universitetas']
    >>> form.getControl('Parent').value = ['0']
    >>> browser.getControl('Logo').add_file(*make_file('test_logo.png'))
    >>> form.getControl('Create').click()
    >>> form = browser.getForm(name='new_structure_form')
    >>> form.getControl('Title').value = 'Architekturos fakultetas'
    >>> form.getControl('Short title').value = 'af'
    >>> form.getControl('Description').value = ''
    >>> form.getControl('Parent').displayOptions
    ['Select a parent', 'U-niversity', 'Vilniaus universitetas', 'Vilniaus Gedimino Technikos Universitetas']
    >>> form.getControl('Parent').value = ['7']
    >>> form.getControl('Create').click()

END OF SETTING UP
Not logged in user can see students number of university

    >>> browser = Browser()
    >>> browser.open('http://localhost/school/vu')
    >>> browser.printQuery("//li[@class='studentsNumber']")
    <li class="studentsNumber">
      <span class="bold">0</span> students
          </li>

But he can't see button "I study here"

    >>> browser.printQuery("//form[@id='i_study_here']")

Logged user should not see "I study here" button in university and faculty portlet,
because he already has his LocationTag set:

    >>> browser = Browser.logIn()
    >>> browser.open('http://localhost/school/vu')
    >>> browser.printQuery("//form[@id='i_study_here_form']")

    >>> browser.open('http://localhost/school/vgtu')
    >>> browser.printQuery("//form[@id='i_study_here_form']")

    >>> browser.open('http://localhost/school/uni')
    >>> browser.printQuery("//form[@id='i_study_here_form']")

    >>> browser.open('http://localhost/school/vu/ef')
    >>> browser.printQuery("//form[@id='i_study_here_form']")

But he sees "I study here" button in HIS university faculties:

    >>> browser.open('http://localhost/school/uni/dep')
    >>> browser.printQuery("//form[@id='i_study_here_form']")
    <form id="i_study_here_form" method="post" action="/profile/set_location?location_id=2">
      <button class="btn" value="I study here">
        <span>I study here</span>
      </button>
    </form>

If user is joined faculty, he doesn't see "I study here" at all

    >>> browser.getControl('I study here').click()

    >>> browser.open('http://localhost/school/vgtu')
    >>> browser.printQuery("//form[@id='i_study_here_form']")

    >>> browser.open('http://localhost/school/vu/')
    >>> browser.printQuery("//form[@id='i_study_here_form']")

    >>> browser.open('http://localhost/school/vgtu/af')
    >>> browser.printQuery("//form[@id='i_study_here_form']")

    >>> browser.open('http://localhost/school/vu/ef')
    >>> browser.printQuery("//form[@id='i_study_here_form']")

    >>> browser.open('http://localhost/school/uni')
    >>> browser.printQuery("//form[@id='i_study_here_form']")

    >>> browser.open('http://localhost/school/uni/dep')
    >>> browser.printQuery("//form[@id='i_study_here_form']")
