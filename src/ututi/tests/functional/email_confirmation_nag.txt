Test nagging users to confirm their emails
==========================================

   >>> from ututi.lib.mailer import mail_queue

   >>> browser = Browser.logIn('user3@ututi.lt', 'password')
   >>> browser.printQuery("//div[@class='flash-message']/span")
   <span class="close-link hide-parent">Close</span>
   <span>
     Your <strong>email</strong> is not confirmed! Please confirm your email by clicking on the link sent to your address or
     <form method="post" action="/profile/confirm_emails" id="email_confirmation_request" class="inline-form">
       <div>
         <input type="hidden" name="came_from" value="http://localhost/home" />
         <input type="hidden" name="email" value="user3@ututi.lt" />
         <input type="submit" class="text_button" value="get another confirmation email" style="font-size: 13px;" />
       </div>
     </form>
   </span>


   >>> browser.getControl('get another confirmation email').click()
   >>> browser.printQuery("//div[@class='flash-message']/span")
   <span class="close-link hide-parent">Close</span>
   <span>Confirmation message sent. Please check your email.</span>
   <span class="close-link hide-parent">Close</span>
   <span>
       Your <strong>email</strong> is not confirmed! Please confirm your email by clicking on the link sent to your address or
       <form method="post" action="/profile/confirm_emails" id="email_confirmation_request" class="inline-form">
       <div>
         <input type="hidden" name="came_from" value="http://localhost/home" />
         <input type="hidden" name="email" value="user3@ututi.lt" />
         <input type="submit" class="text_button" value="get another confirmation email" style="font-size: 13px;" />
       </div>
     </form>
   </span>

   >>> msg = mail_queue.pop()
   >>> print msg.payload()
   We have received a request to confirm the ownership of this email by Third user on the Ututi system. If this email belongs to You, confirm it by clicking on this link:
   <BLANKLINE>
   http://localhost/confirm_user_email/...
   <BLANKLINE>
   Ututi team

   >>> msg.recipients
   [u'user3@ututi.lt']

   >>> from ututi.lib.helpers import get_urls
   >>> urls = get_urls(msg.payload())
   >>> browser = Browser()
   >>> browser.open(urls[0])

   >>> browser.printQuery("//div[@class='flash-message']/span/text()")
   Close
   Your email user3@ututi.lt was confirmed. Thank You.

   >>> browser.printQuery("id('email_unconfirmed')")
